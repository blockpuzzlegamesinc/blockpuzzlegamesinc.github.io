<head>
<!--     <link rel="icon" href="https://cdn.appsflyer.com/af-statics/images/favicon.ico" type="image/x-icon"/>
    <link rel="apple-touch-icon" href="https://cdn.appsflyer.com/af-statics/images/favicon.png" type="image/png"/>
    <link rel="icon" href="https://cdn.appsflyer.com/af-statics/images/favicon.png" type="image/png"/> -->
    <script>
        var mac_redirect = "null";

        function is_mac() {
            return (navigator.platform === 'MacIntel' && !(navigator.maxTouchPoints > 1));
        }

        if (is_mac() && (mac_redirect !== "null")) {
            window.location.href = mac_redirect;
        }
    </script>
</head>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:600" rel="stylesheet">
<style>
    html,
    body {
        height: 100%;
        width: 100%;
    }

    body {
        background: #F5F6F8;
        font-size: 16px;
        font-family: 'Open Sans', sans-serif;
        color: #2C3E51;
    }

    .main {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
    }

    .main > div > div,
    .main > div > span {
        text-align: center;
    }

    .main span {
        display: block;
        padding: 80px 0 170px;
        font-size: 3rem;
    }

    .main .app img {
        width: 400px;
    }
</style>
<body onload="redirect()">
<div class="main">
    <div class="workarea">
        <div id="logo" class="logo">
        </div>
        <span id="app_name"></span>
        <div class="app">
            <img src="./blockpuzzlegamesinc-com_files/app_store_badge.png"
                 onclick="redirect_to_web_store()"/>
        </div>
    </div>
    <script type="text/javascript">
        // 0996175d55005ac441f17061c18a1602
        // c64ef8b30c732f1d79190dfa906c9ceb
        var store_link = "https://smart.link/cpknu8r1z8y2b";
        var appIcon = "./blockpuzzlegamesinc-com_files/appicon_elements.png";
        var app_name = "Merge Clash";

        function generateSearchUrl() {
          var url = window.location.href;
          var base_url = store_link + "?",
              valid_params = ["aff_sub", "offer_id", "aff_id", "ios_ifa", "google_aid", "source", "aff_click_id", "adid", "bid_type","bid_won", "click_id", "cp_1", "cp_2", "cp_3", "device_ua", "idfa", "ip_address", "matchtype", "site_id"],
              queries = (url.indexOf('?') >= 0 ? url.split('?')[1].split('&') : []),
              found;
            
           
          if (queries.length > 0) {
            for (var i in queries) {
              found = false;
              for (var qi in valid_params) {
                if (queries[i].indexOf(valid_params[qi]) >= 0) { found = true; }
              }
              if(!found){ queries.splice(i, 1); }
            }
          }
        return this.appStoreUrl = base_url + queries.join('&');
        }



        function is_custom_redirection() {
            return (generateSearchUrl().startsWith("http") && !generateSearchUrl().startsWith("https://apps.apple.com"));
        }

        function redirect_to_web_store() {
            window.location.href = generateSearchUrl();
        }

        function redirect_to_store() {
            if (!document.hidden) {
                if (is_custom_redirection()) {
                    window.location.replace(generateSearchUrl());
                } else {
                    window.location.href = generateSearchUrl();
                }
            }
        }

        document.addEventListener('visibilitychange', function () {
            if (window.history.length > 1) {
                window.history.go(-1); // go back to previous page
            } else {
                window.close();
            }
        });

        if (appIcon !== "null") {
            var logoElement = document.getElementById("logo");
            var imgElement = document.createElement("IMG");
            imgElement.setAttribute("src", appIcon);
            imgElement.setAttribute("style", "width:200px;height:200px;border-radius:20px;");
            imgElement.setAttribute("onclick", "redirect_to_web_store");
            logoElement.appendChild(imgElement);
        }

        if (app_name) {
            var appNameElement = document.getElementById('app_name');
            appNameElement.innerHTML = app_name;
        }

        function redirect() {
            if (is_custom_redirection()) {
                redirect_to_store();
            } else {
                redirect_to_web_store();
            }
        }

    </script>
</div>
</body>